<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>背包加密 &#8212; CTF Wiki  documentation</title>
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/overflow.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="离散对数相关" href="../discrete_log/discrete_log_intro.html" />
    <link rel="prev" title="综合题目" href="../rsa/rsa_complex.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html">
          CTF Wiki</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Chapters <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">CTF 介绍</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/history.html">CTF 竞赛的历史</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/history.html#id1">CTF 的起源</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/history.html#id2">早期 CTF 竞赛</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/history.html#id3">「现代」CTF 竞赛</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/mode.html">CTF 竞赛模式简介</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/mode.html#jeopardy">解题模式 - Jeopardy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/mode.html#belluminar">战争分享模式 - Belluminar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/mode.html#attack-defense">攻防模式 - Attack &amp; Defense</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/content.html">CTF 竞赛内容</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/content.html#id1">全国大学生信息安全竞赛 - 竞赛内容</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/experience.html">线下攻防经验小结</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/experience.html#gamebox">关注 Gamebox 状态</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/experience.html#id2">分清区段与端口</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/experience.html#patch">服务 patch 与防御</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/experience.html#id3">构造脚本框架快速展开攻击</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/experience.html#id4">比赛的一些策略</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/cgc.html">CGC 网络超级挑战赛</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/cgc.html#id1">性能评价指标</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/cgc.html#id2">明确核心任务</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/cgc.html#id3">分析方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/cgc.html#id4">CGC 经验总结</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/resources.html">学习资源</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/resources.html#id2">在线学习</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/resources.html#id3">信息资讯</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/resources.html#id4">论坛</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/resources.html#ctf-oj">CTF OJ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/resources.html#ctf-writeup">CTF Writeup 集合</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/about.html">杂项简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/recon.html">信息搜集技术</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/recon.html#id2">网络信息搜集技巧</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/recon.html#id3">基本搜索技巧</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/recon.html#id4">地图和街景搜索</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/encode/index.html">编码分析</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/encode/communication.html">通信领域常用的编码</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/encode/computer.html">计算机相关的编码</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/encode/modern.html">现实世界中常用的编码</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/prefix.html">取证隐写</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/prefix.html#id2">前置技能</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/prefix.html#python">python操作二进制数据</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/prefix.html#id3">常用工具</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/picture/index.html">图片分析</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/picture/about.html">Image Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/picture/png.html">PNG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/picture/jpg.html">JPG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/picture/gif.html">GIF</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/archive/index.html">压缩包分析</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/archive/zip.html">Zip 格式</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/archive/rar.html">Rar 格式</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/audio/index.html">音频分析</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/audio/index.html#id2">常见手段</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/audio/index.html#mp3">MP3 隐写</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/audio/index.html#id5">波形</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/audio/index.html#id8">频谱</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/audio/index.html#lsb">LSB音频隐写</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/audio/index.html#id13">延伸</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/disk_memory/index.html">磁盘 / 内存分析</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/disk_memory/index.html#id2">常用工具</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/disk_memory/index.html#id3">磁盘</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/disk_memory/index.html#vmdk">VMDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/disk_memory/index.html#id4">内存</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/disk_memory/index.html#id5">题目</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/disk_memory/index.html#id6">参考</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/cap.html">流量分析</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/cap.html#id2">基本工具</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/cap.html#id4">常见题型</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/cap.html#id5">题目</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/others.html">其他</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../misc/others.html#shellcode">shellcode</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Crypto</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">密码学简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../classical/index.html">古典密码</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../classical/monoalphabetic.html">单表代换密码</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../classical/polyalphabetic.html">多表代换加密</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../classical/others.html">其他类型</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../classical/summary.html">总结</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../symmetric/index.html">对称加密</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../symmetric/des.html">DES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../symmetric/aes.html">AES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../symmetric/block_cipher.html">分组模式</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">非对称密码</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../rsa/rsa_index.html">RSA</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">背包加密</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discrete_log/discrete_log_intro.html">离散对数相关</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../hash/index.html">哈希函数</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../hash/md5.html">MD5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hash/sha1.html">SHA1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hash/attack.html">Hash Attack</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../signature/index.html">数字签名</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../signature/rsa.html">RSA数字签名</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../signature/elgamal.html">ElGamal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../signature/dsa.html">DSA</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../others/others.html">证书格式</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../others/others.html#der">DER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../others/others.html#pem">PEM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../others/others.html#id2">格式转换</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Web</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../web/index.html">WEB 简介</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#sql">SQL 注入</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#xss">XSS 跨站脚本攻击</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#id1">命令执行</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#id2">文件包含</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#csrf">CSRF 跨站请求伪造</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#ssrf">SSRF 服务器端请求伪造</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#id3">文件上传</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#id4">点击劫持</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#vps">VPS 虚拟专用服务器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#id5">条件竞争</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#xxe">XXE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#xsch">XSCH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#id6">越权（功能级访问缺失）</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#id7">敏感信息泄露</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#id8">错误的安全配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#waf">WAF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#ids">IDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/index.html#ips">IPS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../web/sqli.html">SQL 注入</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../web/sqli.html#id1">基本概念</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/sqli.html#id2">常用工具</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/sqli.html#id3">注入常见参数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/sqli.html#id4">语法参考与小技巧</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/sqli.html#id8">后台万能密码</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/sqli.html#id9">注入语句备忘</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/sqli.html#id19">参考资料</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../web/xss.html">XSS 跨站脚本攻击</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../web/xss.html#id1">XSS 简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/xss.html#id4">XSS 利用方式</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../web/csrf.html">CSRF 跨站请求伪造</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../web/csrf.html#id1">CSRF 简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/csrf.html#id2">CSRF 类型</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/csrf.html#id3">CSRF 的防御</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../web/ssrf.html">SSRF 服务端请求伪造</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../web/ssrf.html#id1">SSRF 简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/ssrf.html#id2">SSRF 漏洞出现的场景</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/ssrf.html#id3">常用的后端实现</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/ssrf.html#id4">阻碍 SSRF 漏洞利用的场景</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/ssrf.html#id5">利用 SSRF 进行端口扫描</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/ssrf.html#id7">协议利用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/ssrf.html#id8">参考资料</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../web/php.html">PHP 代码审计</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../web/php.html#id1">文件包含</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/php.html#id4">文件上传</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/php.html#id6">变量覆盖</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/php.html#id8">命令执行</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/php.html#id14">PHP 特性</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../web/php.html#id19">寻找源代码备份</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Reverse</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../reverse/index.html">Reverse Engineering</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../reverse/introduction.html">软件逆向工程简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reverse/x86assembly.html">施工中</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reverse/protection.html">施工中</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reverse/analysis/index.html">逆向分析核心技术</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reverse/resources.html">施工中</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Pwn</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../pwn/stackoverflow/index.html">栈溢出</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/stackoverflow/stack_intro.html">栈介绍</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/stackoverflow/stackoverflow_basic.html">栈溢出原理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/stackoverflow/basic_rop.html">基本ROP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/stackoverflow/others.html">花式栈溢出技巧</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/stackoverflow/medium_rop.html">中级ROP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/stackoverflow/advanced_rop.html">高级ROP</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../pwn/fmtstr/index.html">格式化字符串漏洞</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/fmtstr/fmtstr_intro.html">格式化字符串漏洞原理介绍</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/fmtstr/fmtstr_exploit.html">格式化字符串漏洞利用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/fmtstr/fmtstr_example.html">格式化字符串漏洞例子</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/fmtstr/fmtstr_detect.html">格式化字符串漏洞检测</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../pwn/heap/index.html">堆利用</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/heap/heap_basic_intro.html">基本堆介绍</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/heap/heap_structure.html">堆相关数据结构</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/heap/heap_implementation_details.html">深入理解堆的实现</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/heap/heapoverflow_basic.html">堆溢出</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/heap/off_by_one.html">堆中的off-by-one</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/heap/chunk_extend_shrink.html">chunk extend/shrink</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/heap/unlink.html">unlink</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/heap/use_after_free.html">Use After Free</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/heap/fastbin_attack.html">fastbin attack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/heap/unsorted_bin_attack.html">Unsorted Bin Attack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pwn/heap/house_of_lore.html">House of Lore</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Executable</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../executable/elf/index.html">ELF文件</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../executable/elf/elf_structure.html">ELF文件基本结构</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../executable/elf/program_loading.html">程序加载</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../executable/elf/program_linking.html">程序链接</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../executable/elf/running_overview.html">程序执行流程</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Sections <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">背包加密</a><ul>
<li><a class="reference internal" href="#id2">背包问题</a></li>
<li><a class="reference internal" href="#merklehellman">Merkle–Hellman</a><ul>
<li><a class="reference internal" href="#id3">公私钥生成</a><ul>
<li><a class="reference internal" href="#id4">生成私钥</a></li>
<li><a class="reference internal" href="#id5">生成公钥</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id6">加解密</a><ul>
<li><a class="reference internal" href="#id7">加密</a></li>
<li><a class="reference internal" href="#id8">解密</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id9">破解</a></li>
<li><a class="reference internal" href="#id10">例子</a></li>
<li><a class="reference internal" href="#id12">题目</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="../rsa/rsa_complex.html" title="Previous Chapter: 综合题目"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; 综合题目</span>
    </a>
  </li>
  <li>
    <a href="../discrete_log/discrete_log_intro.html" title="Next Chapter: 离散对数相关"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">离散对数相关 &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../../_sources/crypto/asymmetric/knapsack/knapsack_intro.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="id1">
<h1>背包加密<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id2">
<h2>背包问题<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>首先，我们先来介绍一下背包问题，假定一个背包可以称重W，现在有n个物品，其重量分别为 <span class="math">\(a_1, a_2,...,a_n\)</span>
我们想问一下装哪些物品可以恰好使得背包装满，并且每个物品只能被装一次。这其实就是在解这样的一个问题</p>
<p><span class="math">\(x_1a_1+x_2a_2+,...,+x_na_n=W\)</span></p>
<p>其中所有的 <span class="math">\(x_i\)</span>
只能为0和1。显然我们必须枚举所有的n个物品的组合才能解决这个问题，而复杂度也就是 <span class="math">\(2^n\)</span>
。这也就是背包加密的妙处所在。</p>
<p>在加密时，如果我们想要加密的明文为x，那么我们可以将其表示为n位二进制数，然后分别乘上 <span class="math">\(a_i\)</span>
即可得到加密结果。</p>
<p>但是解密的时候，该怎么办呢？？？我们确实让其他人难以解密密文，但是我们自己也确实没有办法解密密文。</p>
<p>但是当 <span class="math">\(a_i\)</span>
是超递增的话，我们就有办法解了，所谓超递增是指序列满足如下条件</p>
<p><span class="math">\(a_i&gt;\sum_{k=1}^{i-1}a_k\)</span></p>
<p>即第i个数大于前面所有数的和。</p>
<p>为什么满足这样的条件就可以解密了呢？这是因为如果加密后的结果大于 <span class="math">\(a_n\)</span>
的话，其前面的系数为必须1的。反之，无论如何也无法使得等式成立。因此，我们可以立马得到对应的明文。</p>
<p>但是，这样又出现了一个问题，由于 <span class="math">\(a_i\)</span>
是公开的，如果攻击者截获了密文，那么它也就很容易去破解这样的密码。为了弥补这样的问题，就出现了Merkle–Hellman这样的加密算法，我们可以使用初始的背包集作为私钥，变换后的背包集作为公钥，再稍微改动加密过程，即可。</p>
<p>这里虽然说了超递增序列，但是却没有说是如何生成的。</p>
</div>
<div class="section" id="merklehellman">
<h2>Merkle–Hellman<a class="headerlink" href="#merklehellman" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id3">
<h3>公私钥生成<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id4">
<h4>生成私钥<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>私钥就是我们的初始的背包集，这里我们使用超递增序列，怎么生成呢？我们可以假设 <span class="math">\(a_1=1\)</span> ，
那么 <span class="math">\(a_2\)</span> 大于1即可，类似的可以依次生成后面的值。</p>
</div>
<div class="section" id="id5">
<h4>生成公钥<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p>在生成公钥的过程中主要使用了模乘的运算。</p>
<p>首先，我们生成模乘的模数m，这里要确保</p>
<p><span class="math">\(m&gt;\sum_{i=1}^{i=n}a_i\)</span></p>
<p>其次，我们选择模乘的乘数w，作为私钥并且确保</p>
<p><span class="math">\(gcd(w,m)=1\)</span></p>
<p>之后，我们便可以通过如下公式生成公钥</p>
<p><span class="math">\(b_i \equiv w a_i \bmod m\)</span></p>
<p>并将这个新的背包集 <span class="math">\(b_i\)</span> 和m作为公钥。</p>
</div>
</div>
<div class="section" id="id6">
<h3>加解密<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id7">
<h4>加密<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>假设我们要加密的明文为v，其每一个比特位为 <span class="math">\(v_i\)</span>
，那么我们加密的结果为</p>
<p><span class="math">\(\sum_{i=1}^{i=n}b_iv_i \bmod m\)</span></p>
</div>
<div class="section" id="id8">
<h4>解密<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<p>对于解密方，首先可以求的w关于m的逆元 <span class="math">\(w^{-1}\)</span> 。</p>
<p>然后我们可以将得到的密文乘以 <span class="math">\(w^{-1}\)</span> 即可得到明文，这是因为</p>
<p><span class="math">\(\sum_{i=1}^{i=n}w^{-1}b_iv_i \bmod m=\sum_{i=1}^{i=n}a_iv_i \bmod m\)</span></p>
<p>这里有 <span class="math">\(b_i \equiv w a_i \bmod m\)</span> 。</p>
<p>对于每一块的加密的消息都是小于m的，所以求得结果自然也就是明文了。</p>
</div>
</div>
<div class="section" id="id9">
<h3>破解<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>该加密体制在提出后两年后该体制即被破译，破译的基本思想是我们不一定要找出正确的乘数w（即陷门信息），只需找出任意模数m′和乘数w′，只要使用w′去乘公开的背包向量B时，能够产生超递增的背包向量即可。</p>
<p>具体的原理可以参考相应的论文，在ref文件夹内。</p>
</div>
<div class="section" id="id10">
<h3>例子<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>参考 <a class="reference external" href="https://github.com/ctfs/write-ups-2014/tree/b02bcbb2737907dd0aa39c5d4df1d1e270958f54/asis-ctf-quals-2014/archaic">github</a> 。</p>
<p>这里我们以2014 年 ASIS Cyber Security Contest Quals 中的 Archaic为例。</p>
<p>首先查看源程序</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">secret</span> <span class="o">=</span> <span class="s1">&#39;CENSORED&#39;</span>
<span class="n">msg_bit</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">secret</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">),</span> <span class="mi">16</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span>
</pre></div>
</div>
<p>首先得到了secret的所有二进制位。</p>
<p>其次，利用如下函数得到keypair，包含公钥与私钥。</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">keyPair</span> <span class="o">=</span> <span class="n">makeKey</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">msg_bit</span><span class="p">))</span>
</pre></div>
</div>
<p>仔细分析makekey函数，如下</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">makeKey</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">privKey</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="o">**</span><span class="n">n</span><span class="p">)]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">privKey</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">privKey</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="o">**</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="n">i</span><span class="p">)))</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">privKey</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">privKey</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">privKey</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
    <span class="n">pubKey</span> <span class="o">=</span> <span class="p">[</span> <span class="n">r</span><span class="o">*</span><span class="n">w</span> <span class="o">%</span> <span class="n">q</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">privKey</span> <span class="p">]</span>
    <span class="k">return</span> <span class="n">privKey</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">pubKey</span>
</pre></div>
</div>
<p>可以看出prikey是一个超递增序列，并且得到的q比prikey中所有数的和还要大，此外我们得到的r，恰好与q互素，这一切都表明了该加密是一个背包加密。</p>
<p>果然加密函数就是对于消息的每一位乘以对应的公钥并求和。</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">pubKey</span><span class="p">):</span>
    <span class="n">msg_bit</span> <span class="o">=</span> <span class="n">msg</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pubKey</span><span class="p">)</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">msg_bit</span><span class="p">:</span>
        <span class="n">cipher</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bit</span><span class="p">)</span><span class="o">*</span><span class="n">pubKey</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="nb">bin</span><span class="p">(</span><span class="n">cipher</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>
</pre></div>
</div>
<p>对于破解的脚本我们直接使用 <a class="reference external" href="https://github.com/ctfs/write-ups-2014/tree/b02bcbb2737907dd0aa39c5d4df1d1e270958f54/asis-ctf-quals-2014/archaic">github</a>
上的脚本。进行一些简单的修改。</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">binascii</span>
<span class="c1"># open the public key and strip the spaces so we have a decent array</span>
<span class="n">fileKey</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;pub.Key&quot;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
<span class="n">pubKey</span> <span class="o">=</span> <span class="n">fileKey</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;[]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">nbit</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pubKey</span><span class="p">)</span>
<span class="c1"># open the encoded message</span>
<span class="n">fileEnc</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;enc.txt&quot;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
<span class="n">encoded</span> <span class="o">=</span> <span class="n">fileEnc</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;start&quot;</span>
<span class="c1"># create a large matrix of 0&#39;s (dimensions are public key length +1)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">nbit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nbit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># fill in the identity matrix</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">nbit</span><span class="p">):</span>
    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1"># replace the bottom row with your public key</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">nbit</span><span class="p">):</span>
    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">nbit</span><span class="p">]</span> <span class="o">=</span> <span class="n">pubKey</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="c1"># last element is the encoded message</span>
<span class="n">A</span><span class="p">[</span><span class="n">nbit</span><span class="p">,</span> <span class="n">nbit</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nbit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="c1"># print solution</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">M</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">m</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
        <span class="nb">print</span> <span class="n">i</span><span class="p">,</span> <span class="n">M</span>
        <span class="n">M</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">M</span><span class="p">)</span>
        <span class="c1"># remove the last bit</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">M</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="mi">2</span><span class="p">))[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span> <span class="n">M</span>
</pre></div>
</div>
<p>PS:不知道为啥，linux上的sage总是语法有问题，，，是时候找个合适的编辑器了啊。。本来想直接在代码里解码，但怎么试都不行，，不知道为啥，先搞出来再说吧。。。</p>
<p>输出之后再解码下</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="mi">295</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="mi">415349535</span><span class="n">f3962643364356664323432323638326331393536383830366130373036316365</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">binascii</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="s1">&#39;415349535f3962643364356664323432323638326331393536383830366130373036316365&#39;</span><span class="p">)</span>
<span class="s1">&#39;ASIS_9bd3d5fd2422682c19568806a07061ce&#39;</span>
</pre></div>
</div>
<p>需要注意的是，我们得到的LLL攻击得到的矩阵res的只包含01值的行才是我们想要的结果，因为我们对于明文加密时，会将其分解为二进制比特串。此外，我们还需要去掉对应哪一行的最后一个数字。</p>
<p>flag是ASIS_9bd3d5fd2422682c19568806a07061ce。</p>
</div>
<div class="section" id="id12">
<h3>题目<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>2017 国赛 classic</li>
</ul>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016-2017, CTF Wiki.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>