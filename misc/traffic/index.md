流量包分析
===

CTF 比赛中,流量包的取证分析是另一项重要的考察方向。

通常比赛中会提供一个包含流量数据的PCAP文件，有时候也会需要选手们先进行修复or重构传输文件后,再进行分析。

PCAP这一块作为重点考察方向,复杂的地方在于数据包里充满着大量无关的流量信息，因此如何分类和过滤数据是参赛者需要完成的工作。


正如同文件雕复指的是识别和提取加载在其他文件中的文件一样，报文雕复指的是从抓到的数据包中提取出文件。有一些昂贵的商业工具专门完成这类工作，但Xplico框架作为开源工具，也能满足这一需求。Wireshark也有一个能够将数据从抓包中提取的功能‘导出对象’（例如：文件—到处对象—HTTP—保存全部），除此之外，你也可以尝试tcpxtract,Network Miner,Foremost,或是Snort。
如果你想要编写自己的脚本来直接处理PCAP文件，那么推荐用于操作pcap的Python包dpkt，你也可以用Wirepy来写Wireshark的交互。

如果你要尝试修复损坏的PCAP文件，这里有一个叫做PCAPfix的在线修复PCAP文件服务。

注意PCAP和PCAPNG的不同：这是两种版本的PCAP文件格式。PCAPNG版本较新，因此有工具不支持该类型文件。你可能需要使用Wireshark或其他兼容工具将PCAPNG文件转换为PCAP从而在其他工具中使用。